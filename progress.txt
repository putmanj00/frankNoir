# FrankNoir - Valentine's Day Scavenger Hunt
Start Date: 2026-02-08
Target: 2026-02-14 (Valentine's Day)
Timeline: 6 days

## Project Overview
Creating an immersive scavenger hunt experience for my wife that recreates 14 years of relationship history across Cincinnati locations. The experience mimics EXIT: The game with puzzles, GPS tracking, and a "Lisa Frank Noir" aesthetic (cyberpunk/synthwave with neon on black).

## Technical Stack
- Next.js 16 (App Router)
- HeroUI + Tailwind CSS
- TypeScript (strict mode)
- Client-only (no backend)
- localStorage for persistence
- Geolocation API for GPS
- Web Audio API for puzzles
- PWA (installable)
- Vercel hosting

## Story Log
(Ralph will append here after each story completion)

## 2026-02-08 - Story #E1-S1: Initialize Next.js 16 project with HeroUI + Tailwind

**Implementation**:
- Installed Next.js 16.1.6, React 19, TypeScript 5.9
- Installed and configured HeroUI 2.8.8 with Tailwind CSS 4
- Set up TypeScript in strict mode with proper paths (@/*)
- Created basic App Router structure with layout and page components
- Configured JetBrains Mono font via Google Fonts
- Created globals.css with Lisa Frank Noir color tokens as CSS variables

**Files Changed**:
- package.json - Added all dependencies and dev scripts
- tsconfig.json - TypeScript config with strict mode
- tailwind.config.ts - Tailwind + HeroUI config with custom colors
- next.config.js - Next.js config with HeroUI transpilePackages
- postcss.config.mjs - PostCSS config for Tailwind
- app/layout.tsx - Root layout with HeroUIProvider and JetBrains Mono
- app/page.tsx - Basic home page placeholder
- app/globals.css - Color tokens, glassmorphism, and gradient button styles
- .gitignore - Standard Next.js gitignore
- .eslintrc.json - ESLint config

**Testing**:
- Ran `npm run typecheck` - passes without errors
- All dependencies installed successfully
- Project structure matches planned architecture

**Learnings**:
- create-next-app has interactive prompts, manual setup was faster for automation
- HeroUI requires transpilePackages config in next.config.js
- CSS variables defined in :root for easy access throughout the app
- Tailwind 4 is more streamlined than v3


## 2026-02-08 - Story #E1-S2: Implement Lisa Frank Noir color system and glassmorphism

**Implementation**:
- This was completed as part of E1-S1
- All color tokens defined in globals.css as CSS variables
- Glassmorphism card style (.glass-card) with backdrop blur and neon magenta border
- Gradient button style (.gradient-button) with purple-to-magenta gradient
- JetBrains Mono font loaded via Google Fonts in layout.tsx

**Files Changed**:
- No additional files changed (work done in E1-S1)

**Testing**:
- Visual inspection of CSS classes
- All color tokens accessible via var() syntax
- Glassmorphism and gradient styles ready for component use

**Learnings**:
- Combining setup stories reduced duplication
- CSS utility classes provide reusable patterns
- Color tokens in CSS variables make theming easier


## 2026-02-08 - Story #E1-S3: Create timeline dashboard with 15 stage cards

**Implementation**:
- Created lib/stages.ts with Stage interface and INITIAL_STAGES data (15 placeholder stages)
- Built StageCard component using HeroUI Card with glassmorphism styling
- Implemented status chips (Locked/Active/Completed) with correct colors from Stitch specs
- Updated app/page.tsx to display vertical scrolling timeline
- Added "rim lighting" effect using neon magenta border (1px stroke)
- Applied monospaced font (JetBrains Mono) to match terminal aesthetic
- Cards show: stage number, subtitle, time, location, description (when unlocked)

**Files Changed**:
- lib/stages.ts - Stage type definitions and initial 15-stage data structure
- components/StageCard.tsx - Card component with status chips and glassmorphism
- app/page.tsx - Timeline dashboard with vertical scroll layout

**Testing**:
- Ran `npm run typecheck` - passes without errors
- All 15 stages display in timeline
- Status colors match Stitch specs (Grey/Gold/Purple)
- Mobile-first responsive layout (max-w-2xl container)

**Learnings**:
- HeroUI Card component integrates well with custom glass-card CSS class
- Status chips use inline styles for exact color matching (#ffb622, #ac3cfe)
- isPressable prop enables interactive cards (active/completed stages only)
- Locked stages have reduced opacity (0.6) for visual hierarchy


## 2026-02-08 - Story #E1-S4: Build status chip component (Locked/Active/Completed)

**Implementation**:
- This was completed as part of E1-S3 within StageCard component
- Used HeroUI Chip component with three status states
- Locked: default grey chip (HeroUI default variant)
- Active: Solar Flare Gold (#ffb622) background with dark text
- Completed: Lisa Frank Purple (#ac3cfe) background with white text
- Status determined by stage.status property

**Files Changed**:
- No additional files (implemented in components/StageCard.tsx)

**Testing**:
- Visual inspection shows correct colors for each state
- Status transitions work when stage data changes
- Chips display correctly on mobile viewports

**Learnings**:
- HeroUI Chip accepts inline styles for custom colors
- Combining chip with card creates clear visual hierarchy
- Status indicators are immediately recognizable


## 2026-02-08 - Story #E1-S5: Implement localStorage progress tracking

**Implementation**:
- Created lib/storage.ts with saveProgress() and loadProgress() utilities
- Added version tracking for future migration support (v1.0)
- Implemented error handling for corrupt data, quota exceeded, etc.
- Added helper functions: clearProgress(), hasSavedProgress(), getLastUpdated()
- Updated app/page.tsx to load saved progress on mount
- Auto-save progress whenever stages state changes
- Added loading state while initial data loads

**Files Changed**:
- lib/storage.ts - localStorage utilities with error handling
- app/page.tsx - Added useEffect hooks for load/save, loading state

**Testing**:
- Ran `npm run typecheck` - passes without errors
- Progress structure includes version, stages array, lastUpdated timestamp
- Error handling gracefully handles missing/corrupt localStorage data
- Auto-save triggers on stage state changes

**Learnings**:
- localStorage is synchronous but can throw errors (quota, corruption)
- Try-catch blocks essential for robust storage handling
- Version field enables future data migrations
- useEffect dependencies control when save occurs (isLoaded flag prevents double-save)


## 2026-02-08 - Story #E2-S1: Implement GPS tracking hook with accuracy fallback

**Implementation**:
- Created lib/gps.ts with Haversine distance calculation
- Implemented useGPSTracking hook with continuous position tracking
- Added accuracy fallback: tries high accuracy first, falls back to lower if timeout
- Minimum accuracy threshold (100m default, configurable)
- Distance calculation helper: distanceTo(lat, lon)
- GPS quality indicators (excellent/good/fair/poor) with Lisa Frank Noir colors
- Error parsing with user-friendly messages
- Created GPSStatus component to display GPS state
- Auto-refresh every 5 seconds using watchPosition API

**Files Changed**:
- lib/gps.ts - Distance calculations, accuracy quality, error parsing
- hooks/useGPSTracking.ts - Main GPS tracking hook with fallback logic
- components/GPSStatus.tsx - Visual GPS status indicator with chips

**Testing**:
- Ran `npm run typecheck` - passes without errors
- Hook returns: position, error, isLoading, isSupported, distanceTo(), refresh()
- Accuracy fallback logic prevents blocking on high-accuracy timeout
- Distance calculation uses Haversine formula (accurate to ~0.5%)

**Learnings**:
- watchPosition provides continuous updates vs. getCurrentPosition (one-time)
- High accuracy can timeout on some devices (fallback essential)
- Accuracy varies: indoor 50-100m, outdoor 5-20m, ideal <10m
- useCallback prevents infinite re-renders in useEffect dependencies
- GPS quality colors match Lisa Frank Noir palette


## 2026-02-08 - Story #E2-S2: Build sequential unlock logic

**Implementation**:
- Created lib/unlock.ts with stage unlock utilities
- completeStage() - marks stage complete and unlocks next
- initializeStageStatuses() - sets Stage 1 as active, rest locked
- canUnlockStage() - checks if previous stage is completed
- getActiveStage() - returns current active stage
- getProgress() - calculates completion percentage
- isJourneyComplete() - checks if all stages done
- forceUnlockStage() - admin override for testing
- Updated app/page.tsx to use sequential unlock logic
- Added handleCompleteStage callback
- Added journey complete celebration message
- Progress persists via localStorage (auto-save)

**Files Changed**:
- lib/unlock.ts - All sequential unlock utilities
- app/page.tsx - Integrated unlock logic, progress tracking, complete handler

**Testing**:
- Ran `npm run typecheck` - passes without errors
- Stage 1 initializes as 'active'
- Completing a stage unlocks the next
- Progress counter shows X/15 stages with percentage
- Journey complete message shows when all 15 stages done

**Learnings**:
- Sequential unlock prevents skipping ahead
- State management with useCallback prevents re-render loops
- initializeStageStatuses runs on first load (useState initializer)
- Progress persists automatically via useEffect + localStorage


## 2026-02-08 - Story #E2-S3: Build proximity unlock logic

**Implementation**:
- Created ProximityUnlock component with GPS-based unlocking
- Checks if user is within configurable radius (default 15-50m per stage)
- Shows distance to target with formatDistance() helper
- Progress bar shows proximity percentage
- Visual feedback when in range (purple chip, unlock button)
- Manual override button in dev mode (?dev=true or localhost)
- Created stage detail page at /stage/[id]
- Dynamic route shows stage info, clue, unlock mechanism
- Different unlock UIs for: gps, puzzle, scan, time
- Prevents access to locked stages
- Auto-navigation back to timeline after completion

**Files Changed**:
- components/ProximityUnlock.tsx - GPS proximity unlock component
- app/stage/[id]/page.tsx - Stage detail page with unlock interfaces
- app/page.tsx - Added router navigation to stage detail on click

**Testing**:
- Ran `npm run typecheck` - passes without errors
- Distance calculation uses Haversine formula
- Progress bar fills as user approaches target
- Dev mode manual override for testing without GPS
- Stage detail page loads correctly for active/completed stages
- Locked stages show "stage is locked" message

**Learnings**:
- Next.js App Router dynamic routes: app/stage/[id]/page.tsx
- useParams() gets route parameters client-side
- Dev mode detection via query param or localhost hostname
- Progress bar uses HeroUI Progress with custom CSS variables
- Auto-navigation with setTimeout gives user visual feedback before redirect

